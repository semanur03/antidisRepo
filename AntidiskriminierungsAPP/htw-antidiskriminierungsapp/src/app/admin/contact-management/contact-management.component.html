<body>
    <div class="container">
        <div class="col-12">
            <div class="header row">
                <i class="col-1 fa-solid fa-chevron-left" [routerLink]="['/admin-home']"></i>
                <h1 class="col-9">{{ 'contact-management.page.title' | translate }}</h1>
            </div>
            <br>
            <div>
                <h2>{{ 'contact-management.page.title.2' | translate }}</h2>
                <h3>{{ 'contact-management.page.h.1' | translate }}</h3>
            </div>

            <div class="buttons">
          <div>
            <button class="btn btn-primary" type="button" [routerLink]="['/contact-sprache']">
              Sprache
            </button>
          </div>
          <div>
            <button class="btn btn-primary" type="button" [routerLink]="['/contact-gremium']">
              Gremium
            </button>
          </div>
          <div>
            <button class="btn btn-primary" type="button" [routerLink]="['/contact-mitgliedergruppe']">
              Mitgliedergruppe
            </button>
          </div>
          <div>
            <button class="btn btn-primary" type="button" [routerLink]="['contact-organisationseinheit']">
              Organisationseinheit
            </button>
          </div>
        </div>
        <br>
        <!-- Add New Button -->
        <div class="contact-add-container">
          <span class="contact-add-label">{{ 'contact-management.page.h.2' | translate }}</span>
          <button class="btn btn-sm contact-add-contact" (click)="openAddModal()">
              <i class="bi bi-person-plus"></i>
          </button>
        </div>

        <div class="container table-responsive">
          <!-- Mobile Cards -->
          <div class="card d-md-none" style="width: 20rem; margin: 3%" *ngFor="let contact of allcontacts; trackBy: trackByContact">
            <div class="card-body">
              <div class="name-contact">
                <p class="card-title">{{ contact.titel || '' }} {{ contact.vorname }} {{ contact.nachname }}</p>
              </div>
              <p class="card-subtitle mb-2 text-muted">{{ contact.sprache || '' }}</p>
              <p class="card-text">{{ 'contactlist.phone' | translate }}: {{ contact.telefon || '' }}</p>
              <p class="card-text">{{ 'contactlist.email' | translate }}: {{ contact.email }}</p>
            <p class="card-text">{{ 'contactlist.membergroup' | translate }}: {{ (contact.mitgliedergruppe || '') | translate }}</p>
            <p class="card-text">{{ 'contactlist.committee' | translate }}: {{ (contact.gremium || '') | translate }}
                <span *ngIf="contact.gremium1">, {{ (contact.gremium1 || '') | translate }} </span>
                <span *ngIf="contact.gremium2">, {{ (contact.gremium2 || '') | translate }} </span>
            </p>
            <p class="card-text">{{ 'contactlist.organizational.unit' | translate }}: {{ (contact.organisationseinheit || '') | translate }}</p>

              <!-- Buttons -->
              <button class="btn btn-warning me-2" (click)="openEditModal(contact)">
                <i class="fa-solid fa-pen-to-square"></i>
              </button>
              <button class="btn btn-danger" (click)="openDeleteModal(contact)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </div>
          </div>

          <!-- Desktop Cards -->
          <div class="card d-none d-md-block" style="width: 50rem; margin: 3%" *ngFor="let contact of allcontacts; trackBy: trackByContact">
            <div class="card-body">
              <div class="name-contact">
                <h5 class="card-title">{{ contact.titel || '' }} {{ contact.vorname }} {{ contact.nachname }}</h5>
              </div>
              <p class="card-subtitle mb-2 text-muted">{{ contact.sprache || '' }}</p>
              <p class="card-text">{{ 'contactlist.phone' | translate }}: {{ contact.telefon || '' }}</p>
              <p class="card-text">{{ 'contactlist.email' | translate }}: {{ contact.email }}</p>
            <p class="card-text">{{ 'contactlist.membergroup' | translate }}: {{ (contact.mitgliedergruppe || '') | translate }}</p>
            <p class="card-text">{{ 'contactlist.committee' | translate }}: {{ (contact.gremium || '') | translate }}
                <span *ngIf="contact.gremium1">, {{ (contact.gremium1 || '') | translate }} </span>
                <span *ngIf="contact.gremium2">, {{ (contact.gremium2 || '') | translate }} </span>
            </p>
            <p class="card-text">{{ 'contactlist.organizational.unit' | translate }}: {{ (contact.organisationseinheit || '') | translate }}</p>

              <!-- Buttons -->
              <button class="btn btn-warning me-2" (click)="openEditModal(contact)">
                <i class="fa-solid fa-pen-to-square"></i>
              </button>
              <button class="btn btn-danger" (click)="openDeleteModal(contact)">
                <i class="fa-solid fa-trash"></i>
              </button>
            </div>
          </div>

          <!-- Modal: Hinzufügen -->
          <ng-template #addModal>
            <div class="modal-header">
              <h4 class="modal-title">{{ 'contacts-management.modal.add.title' | translate }}</h4>
            </div>
            <div class="modal-body">
              <input [(ngModel)]="newContact.titel" placeholder="{{ 'contactlist.title' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="newContact.vorname" placeholder="{{ 'contactlist.firstname' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="newContact.nachname" placeholder="{{ 'contactlist.lastname' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="newContact.telefon" placeholder="{{ 'contactlist.phone' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="newContact.email" placeholder="Email" class="form-control mb-2">
              <!-- Dropdown für Sprachen -->
              <div class="mb-3">
                <label class="form-label">{{ 'contactlist.language' | translate }}</label>
                <div *ngFor="let sprache of sprachen" class="form-check">
                  <input class="form-check-input" 
                        type="checkbox" 
                        [id]="'sprache_' + sprache.id"
                        [checked]="isSpracheSelected(sprache.id)"
                        (change)="toggleSpracheSelection(sprache.id)">
                  <label class="form-check-label" [for]="'sprache_' + sprache.id">
                    {{ sprache.sprache }}
                  </label>
                </div>
              </div>
              <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-primary" (click)="saveNewContact()">{{ 'button.save' | translate }}</button>
              <button class="btn btn-secondary" (click)="modalService.dismissAll()">{{ 'button.cancel' | translate }}</button>
            </div>
          </ng-template>

          <!-- Modal: Bearbeiten -->
          <ng-template #editModal>
            <div class="modal-header">
              <h4 class="modal-title">{{ 'contacts-management.modal.edit.title' | translate }}</h4>
            </div>
            <div class="modal-body">
              <input [(ngModel)]="selectedContact!.titel" placeholder="{{ 'contactlist.title' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="selectedContact!.vorname" placeholder="{{ 'contactlist.firstname' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="selectedContact!.nachname" placeholder="{{ 'contactlist.lastname' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="selectedContact!.telefon" placeholder="{{ 'contactlist.phone' | translate }}" class="form-control mb-2">
              <input [(ngModel)]="selectedContact!.email" placeholder="Email" class="form-control mb-2">
            </div>
            <!-- Sprach-Checkboxen -->
            <div class="mb-3">
              <label class="form-label">{{ 'contactlist.language' | translate }}</label>
              <div *ngFor="let sprache of sprachen" class="form-check">
                <input class="form-check-input"
                      type="checkbox"
                      [id]="'edit_sprache_' + sprache.id"
                      [checked]="isEditSpracheSelected(sprache.id)"
                      (change)="toggleEditSpracheSelection(sprache.id)">
                <label class="form-check-label" [for]="'edit_sprache_' + sprache.id">
                  {{ sprache.sprache }}
                </label>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-primary" (click)="saveUpdatedContact()">{{ 'button.save' | translate }}</button>
              <button class="btn btn-secondary" (click)="modalService.dismissAll()">{{ 'button.cancel' | translate }}</button>
            </div>
          </ng-template>

          <!-- Modal: Löschen -->
          <ng-template #deleteModal>
            <div class="modal-header">
              <h4 class="modal-title">{{ 'contacts-management.modal.delete.title' | translate }}</h4>
            </div>
            <div class="modal-body">
              {{ 'contacts-management.modal.delete.confirm' | translate }}
              <strong>{{ selectedContact?.vorname }} {{ selectedContact?.nachname }}</strong>
            </div>
            <div class="modal-footer">
              <button class="btn btn-danger" (click)="deleteContact(selectedContact?.id)">{{ 'button.delete' | translate }}</button>
              <button class="btn btn-secondary" (click)="modalService.dismissAll()">{{ 'button.cancel' | translate }}</button>
            </div>
          </ng-template>
        </div>
      </div>
  </div>
  <br>
  <br>
  <br>
</body>
